{"ast":null,"code":"// import session from './session'\n// const CREATE_REVIEW = 'create/review'\n// const EDIT_REVIEW = 'edit/review'\n// const GET_REVIEWS = 'get/reviews'\n// // ACTIONS\n// const create_review = (product_id,data) =>{\n\n//     return {\n//         type:CREATE_REVIEW,\n//         payload:{\n//             product_id,\n//             data\n//         }\n//     }\n// }\n\n// const get_reviews = (data) =>{\n\n//     return {\n//         type:GET_REVIEWS,\n//         payload:data\n\n//     }\n// }\n\n//THUNKS\nexport const getAllReviewsThunk = () => async (dispatch, getState) => {\n  const res = await fetch('/api/review/get/reviews', {\n    method: \"GET\"\n  });\n  if (res.ok) {\n    const data = await res.json();\n    console.log(\"the data coming back is\", data);\n    dispatch(get_reviews(data));\n    return data;\n  }\n};\nexport const createReviewThunk = (product_id, review) => async (dispatch, getState) => {\n  const res = await fetch('/api/review/new_review', {\n    method: \"POST\",\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(review)\n  });\n  if (res.ok) {\n    const data = await res.json();\n    dispatch(create_review(product_id, data));\n    return data;\n  }\n};\n\n//startiig\n\n//Reducers \n\nconst initialState = {\n  allReviews: {},\n  productReviews: {}\n};\nexport const reviewsReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  switch (action.type) {\n    case GET_REVIEWS:\n      {\n        const newState = {\n          ...state,\n          allReviews: {\n            ...state.allReviews\n          }\n        };\n        action.payload.forEach(element => {\n          newState.allReviews[element.id] = element;\n        });\n        return newState;\n      }\n    case CREATE_REVIEW:\n      {\n        const {\n          product_id,\n          data\n        } = action.payload;\n        const newState = {\n          ...state\n        };\n        const targetSpot = newState.productReviews[product_id];\n        console.log(\"the target spot is\", targetSpot);\n        if (targetSpot) {\n          targetSpot.reviews = [...targetSpot.reviews, data];\n          //   allReview = [...allReview]\n          //append the data to all reviews \n        }\n\n        return newState;\n      }\n    default:\n      return state;\n  }\n};\nexport default reviewsReducer;","map":{"version":3,"names":["getAllReviewsThunk","dispatch","getState","res","fetch","method","ok","data","json","console","log","get_reviews","createReviewThunk","product_id","review","headers","body","JSON","stringify","create_review","initialState","allReviews","productReviews","reviewsReducer","state","action","type","GET_REVIEWS","newState","payload","forEach","element","id","CREATE_REVIEW","targetSpot","reviews"],"sources":["/Users/zenw/Capstone/Captone-Project/react-app/src/store/review.js"],"sourcesContent":["// import session from './session'\n// const CREATE_REVIEW = 'create/review'\n// const EDIT_REVIEW = 'edit/review'\n// const GET_REVIEWS = 'get/reviews'\n// // ACTIONS\n// const create_review = (product_id,data) =>{\n \n//     return {\n//         type:CREATE_REVIEW,\n//         payload:{\n//             product_id,\n//             data\n//         }\n//     }\n// }\n\n// const get_reviews = (data) =>{\n \n//     return {\n//         type:GET_REVIEWS,\n//         payload:data\n        \n//     }\n// }\n\n\n\n\n\n\n\n\n\n//THUNKS\nexport const getAllReviewsThunk = ()=>async(dispatch,getState) =>{\n   \n    const res = await fetch('/api/review/get/reviews',{\n        method:\"GET\",\n    \n    })\n    if(res.ok){\n        const data = await res.json()\n        console.log(\"the data coming back is\",data)\n        dispatch(get_reviews(data))\n        return data\n    }\n\n\n}\n\nexport const createReviewThunk = (product_id,review)=>async(dispatch,getState) =>{\n\n \n    const res = await fetch('/api/review/new_review',{\n        method:\"POST\",\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(review),\n\n    })\n    if(res.ok){\n        const data = await res.json()\n        dispatch(create_review(product_id,data))\n        return data\n    }\n\n\n}\n\n\n//startiig\n\n\n\n//Reducers \n\nconst initialState = {allReviews:{}, productReviews:{}}\n\n\nexport const reviewsReducer=(state=initialState ,action)=>{\n   \n    switch(action.type){\n    case GET_REVIEWS:{\n        const newState = {...state , allReviews:{...state.allReviews}}\n        action.payload.forEach(element => {\n            newState.allReviews[element.id] = element\n        });\n        return newState\n    }\n    case CREATE_REVIEW: {\n        \n        const { product_id, data } = action.payload;\n\n        const newState = { ...state}\n        const targetSpot = newState.productReviews[product_id];\n        console.log(\"the target spot is\" ,targetSpot)\n              if (targetSpot) {\n          targetSpot.reviews = [...targetSpot.reviews, data];\n        //   allReview = [...allReview]\n        //append the data to all reviews \n        }\n        return newState;\n     }\n\n\n\n\n        default:\n            return state\n    }\n}\n\nexport default reviewsReducer\n\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAUA;AACA,OAAO,MAAMA,kBAAkB,GAAG,MAAI,OAAMC,QAAQ,EAACC,QAAQ,KAAI;EAE7D,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,yBAAyB,EAAC;IAC9CC,MAAM,EAAC;EAEX,CAAC,CAAC;EACF,IAAGF,GAAG,CAACG,EAAE,EAAC;IACN,MAAMC,IAAI,GAAG,MAAMJ,GAAG,CAACK,IAAI,EAAE;IAC7BC,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAACH,IAAI,CAAC;IAC3CN,QAAQ,CAACU,WAAW,CAACJ,IAAI,CAAC,CAAC;IAC3B,OAAOA,IAAI;EACf;AAGJ,CAAC;AAED,OAAO,MAAMK,iBAAiB,GAAG,CAACC,UAAU,EAACC,MAAM,KAAG,OAAMb,QAAQ,EAACC,QAAQ,KAAI;EAG7E,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,wBAAwB,EAAC;IAC7CC,MAAM,EAAC,MAAM;IACbU,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB,CAAC;IAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACJ,MAAM;EAE/B,CAAC,CAAC;EACF,IAAGX,GAAG,CAACG,EAAE,EAAC;IACN,MAAMC,IAAI,GAAG,MAAMJ,GAAG,CAACK,IAAI,EAAE;IAC7BP,QAAQ,CAACkB,aAAa,CAACN,UAAU,EAACN,IAAI,CAAC,CAAC;IACxC,OAAOA,IAAI;EACf;AAGJ,CAAC;;AAGD;;AAIA;;AAEA,MAAMa,YAAY,GAAG;EAACC,UAAU,EAAC,CAAC,CAAC;EAAEC,cAAc,EAAC,CAAC;AAAC,CAAC;AAGvD,OAAO,MAAMC,cAAc,GAAC,YAA8B;EAAA,IAA7BC,KAAK,uEAACJ,YAAY;EAAA,IAAEK,MAAM;EAEnD,QAAOA,MAAM,CAACC,IAAI;IAClB,KAAKC,WAAW;MAAC;QACb,MAAMC,QAAQ,GAAG;UAAC,GAAGJ,KAAK;UAAGH,UAAU,EAAC;YAAC,GAAGG,KAAK,CAACH;UAAU;QAAC,CAAC;QAC9DI,MAAM,CAACI,OAAO,CAACC,OAAO,CAACC,OAAO,IAAI;UAC9BH,QAAQ,CAACP,UAAU,CAACU,OAAO,CAACC,EAAE,CAAC,GAAGD,OAAO;QAC7C,CAAC,CAAC;QACF,OAAOH,QAAQ;MACnB;IACA,KAAKK,aAAa;MAAE;QAEhB,MAAM;UAAEpB,UAAU;UAAEN;QAAK,CAAC,GAAGkB,MAAM,CAACI,OAAO;QAE3C,MAAMD,QAAQ,GAAG;UAAE,GAAGJ;QAAK,CAAC;QAC5B,MAAMU,UAAU,GAAGN,QAAQ,CAACN,cAAc,CAACT,UAAU,CAAC;QACtDJ,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEwB,UAAU,CAAC;QACvC,IAAIA,UAAU,EAAE;UACpBA,UAAU,CAACC,OAAO,GAAG,CAAC,GAAGD,UAAU,CAACC,OAAO,EAAE5B,IAAI,CAAC;UACpD;UACA;QACA;;QACA,OAAOqB,QAAQ;MAClB;IAKG;MACI,OAAOJ,KAAK;EAAA;AAExB,CAAC;AAED,eAAeD,cAAc"},"metadata":{},"sourceType":"module"}